#include <stdlib.h>
#include <stdio.h>
#include <string.h>
#include <math.h>


void FFT(double c[256], int N, int isign );
double WReal[] = {
    1.000000, 0.998795, 0.995185, 0.989177, 0.980785, 0.970031, 0.956940, 0.941544,
    0.923880, 0.903989, 0.881921, 0.857729, 0.831470, 0.803208, 0.773010, 0.740951,
    0.707107, 0.671559, 0.634393, 0.595699, 0.555570, 0.514103, 0.471397, 0.427555,
    0.382683, 0.336890, 0.290285, 0.242980, 0.195090, 0.146730, 0.098017, 0.049068,
    0.000000, -0.049068, -0.098017, -0.146730, -0.195090, -0.242980, -0.290285, -0.336890,
    -0.382683, -0.427555, -0.471397, -0.514103, -0.555570, -0.595699, -0.634393, -0.671559,
    -0.707107, -0.740951, -0.773010, -0.803208, -0.831470, -0.857729, -0.881921, -0.903989,
    -0.923880, -0.941544, -0.956940, -0.970031, -0.980785, -0.989177, -0.995185, -0.998795,
     -1.000000, -0.998795, -0.995185, -0.989177, -0.980785, -0.970031, -0.956940, -0.941544,
    -0.923880, -0.903989, -0.881921, -0.857729, -0.831470, -0.803208, -0.773010, -0.740951,
    -0.707107, -0.671559, -0.634393, -0.595699, -0.555570, -0.514103, -0.471397, -0.427555,
    -0.382683, -0.336890, -0.290285, -0.242980, -0.195090, -0.146730, -0.098017, -0.049068,
      0.000000, 0.049068, 0.098017, 0.146730, 0.195090, 0.242980, 0.290285, 0.336890,
    0.382683, 0.427555, 0.471397, 0.514103, 0.555570, 0.595699, 0.634393, 0.671559,
    0.707107, 0.740951, 0.773010, 0.803208, 0.831470, 0.857729, 0.881921, 0.903989,
    0.923880, 0.941544, 0.956940, 0.970031, 0.980785, 0.989177, 0.995185, 0.998795,
    
};

//The input data is as follows:
 int inputArr[128] = {
        -12312,-3262,6818,18152,24756,21276,11122,-344,-9002,-8572,2224,13588,17018,14754,10744,6014,
        3436,3906,4510,5034,7536,9214,6338,776,-4126,-7440,-7810,-4686,-1228,-1156,-4122,-8772,
        -14832,-19916,-22320,-22974,-20680,-13822,-3544,11564,29450,31396,10334,-12746,-25586,-28142,16782,3780,
        17626,20520,21882,18984,6014,-8054,-16354,-19508,-12786,4868,19888,21554,14106,2842,-9666,-16768,
        -13916,-5694,4000,15458,23848,22418,13386,2288,-7438,-9472,-304,11472,16568,15658,11872,6464,
        3184,3580,4174,4616,7188,8900,6056,986,-3690,-7286,-7994,-4904,-1244,-668,-3526,-8862,
        -15044,-19184,-21312,-22478,-20384,-14758,-7240,4796,22990,31550,16412,-6202,-20662,-27160,-20804,2050,
        13644,17512,19246,19886,10358,-3410,-12398,-17774,-16250,-2068,14510,19764,15262,6784,-4928,-14416
    };
    
    double c[256];
    
void fft_01()
{
      int i, sp, np;

  //np is the number of FFT inputs
  sp = 0;
  np = 128;

  int ctr;
  ctr=0;

  double it;
  it=0.0;

  //the input array is moved to another array
  //the FFT results are also stored in that array
  //even index is the real part, odd index is the imaginary part
  for(i=0;i<np;++i)
  {
  	c[2*i] = inputArr[ctr];
  	c[2*i+1] = 0.0;
  	it = it + 1.0;
  	ctr++;
  }

  int isign = 1;

  FFT( c, np, isign);

  if(isign == 1){
  printf("\nResults...\n");
  }
  printf("No:\tReal\tImaginer\n");
  for( i = 0; i < np; ++i )
  {
      printf("%d: %lf %lf\n",i+1, c[2*i], c[2*i+1] );
  }
}

/*
The function to compute the actual FFT
*/
void FFT( double c[256], int N, int isign )
{	
	int i,a,b,m;
	int k,n = 0;
	 int to_sin = 3*N/4;
double WN, wk, cs, s, XR[128], XI[128];

	for (k=0;k<N;++k)
	{
		XR[k]=0.0;
		XI[k]=0.0;
		
		 a = 0; b = to_sin;
		for (n=0;n<N;++n)
		{
		//cs=cos(n*wk);
		//s=sin(n*wk);
		cs=WReal[a%N];
		s= WReal[b%N];

		XR[k]=XR[k]+c[2*n]*cs;
		XI[k]=XI[k]+c[2*n]*s;
	 	a += k; b += k;
	    }
	}
	for (k=0,n=1;k<=N; ++n,++k)
	{
		/* store transformed data in x */
		c[2*k]=XR[n-1];
		c[(2*k)+1]=XI[n-1];
	}

}

